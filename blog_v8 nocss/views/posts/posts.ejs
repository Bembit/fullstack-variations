<%- include('../partials/header'); %> 

<div class="main-container">
    <div class="post-container">
       

        <% posts.forEach(function(posts){ %>

            <div class="articles-container">
                
            <div class="articles-image-container">
                    <img src="https://images.unsplash.com/photo-1462804993656-fac4ff489837?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2250&q=80" alt="">
            </div>

            <div class="artices-side-container">
                
                    <h3> <%= posts.name %> </h3>
                
                        
                    <span> <%= moment(posts.created).fromNow() %> </span>
                            
                    <div> by&nbsp;<a class="" href="/users/<%=posts.author.id%>"><%= posts.author.username %></a> </div>
                    <img src="<%= posts.author.avatar %>" alt="user profile picture">
                    
                        
                    <span> <%= posts.created.toDateString() %> </span>
                    <div> <p> <%= posts.content.substring(0, 350) %> ... </p> </div>
                        
                    <a class="" href="/posts/<%=posts._id%>">read the full article</a>

                    <!-- like test on all page -->
                    
                    <div style="padding-bottom: 10px;">
                        <form action="/posts/<%= posts._id %>/like" method="POST">
                            <div class="btn-group">
                                <% if (currentUser && posts.likes.some(function (like) {
                                                                                            return like.equals(currentUser._id)
                                                                                        })) { %>
                                <button class="btn btn-sm btn-primary">
                                    <i class="fas fa-thumbs-up"></i> Liked (<%= posts.likes.length %>)
                                </button>
                                <% } else { %>
                                <button class="btn btn-sm btn-secondary">
                                    <i class="fas fa-thumbs-up"></i> Like (<%= posts.likes.length %>)
                                </button>
                                <% } %>
                            </div>
                        </form>
                    </div>
                    <!--  -->

            </div>


                    <!-- Post Likes Modal Test -->
                    <!-- <div id="postsLikedMain" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title">posts likes: <%= posts.likes.length %></h4>
                                </div>
                                <div class="modal-body">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Liked by:</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% posts.likes.forEach(function(like) { %>
                                            <tr>
                                                <td><span class="badge"><i class="fas fa-user"></i></span> <%= like.username %></td>
                                            </tr>
                                            <% }); %>
                                            <% if (posts.likes.length === 0) { %>
                                            <tr>
                                                <td><em>No likes yet.</em></td>
                                            </tr>
                                            <% } %>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div> -->



        </div>

        <% }); %>


    </div>     
</div>

<%- include('../partials/footer'); %>